"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Selection(e){var n=e.container,t=e.targetSelectors,e=e.options,o=__assign(__assign({},{selectionDivId:"selectionRectangle",leftClickOnly:!0}),e);if(!n)throw new Error("The container element must be defined!");var i=document.createElement("div");i.style.cssText="\n    border: 1px solid #4af;\n    background: rgba(68, 170, 255, 0.5);\n    position: absolute;\n  ",i.hidden=!0,i.id=o.selectionDivId;var l={x1:0,y1:0,x2:0,y2:0},r={mouseDown:!1,moving:!1,mounted:!1,disabled:!1},s=[],d=new Event("_selectstart");function a(e){r.disabled||(o.leftClickOnly&&1!==e.which||(r.mouseDown=!0,l.x1=e.pageX,l.x2=e.pageX,l.y1=e.pageY,l.y2=e.pageY,c()))}function u(e){if(!r.disabled&&r.mouseDown){if(!i.hidden||0===l.x1&&0===l.x2&&0===l.y1&&0===l.y2||(i.hidden=!1),!r.mounted){if(!n)throw new Error("The container element must be defined before mounting the selection rectanble!");n.appendChild(i)}l.x2=e.pageX,l.y2=e.pageY,c(),r.mouseDown&&!r.moving?(i.dispatchEvent(d),r.moving=!0):r.mouseDown&&r.moving&&document.querySelectorAll(t).forEach(function(t){var e=-1!==s.indexOf(t),n=function(e){var t=e.top+window.scrollY,n=e.right+window.scrollX,o=e.bottom+window.scrollY,i=e.left+window.scrollX,e=v();return(e.xleft>=i&&e.xleft<=n||e.xright>=i&&e.xright<=n||i>=e.xleft&&i<=e.xright||n>=e.xleft&&n<=e.xright)&&(e.ytop>=o&&e.ytop<=t||e.ybottom>=o&&e.ybottom<=t||o>=e.ybottom&&o<=e.ytop||o>=e.ybottom&&t<=e.ytop)}(t.getBoundingClientRect());n&&!e?(s.push(t),i.dispatchEvent(new CustomEvent("_selected",{detail:{addedElement:t}}))):!n&&e&&(s=s.filter(function(e){return e!==t}),i.dispatchEvent(new CustomEvent("_removed",{detail:{removedElement:t}})))})}}function m(){i.hidden||(i.hidden=!0),r.moving&&i.dispatchEvent(new CustomEvent("_selectend",{detail:{selectedElements:s}})),f()}function c(){var e=v(),t=n.getBoundingClientRect();i.style.left=e.xleft-(null==t?void 0:t.left)+"px",i.style.top=e.ybottom-(null==t?void 0:t.top)+"px",i.style.width=e.xright-e.xleft+"px",i.style.height=e.ytop-e.ybottom+"px"}function v(){return{xleft:Math.min(l.x1,l.x2),xright:Math.max(l.x1,l.x2),ybottom:Math.min(l.y1,l.y2),ytop:Math.max(l.y1,l.y2)}}function f(){r.mouseDown=!1,r.moving=!1,s=[],l.x1=0,l.y1=0,l.x2=0,l.y2=0,r.mounted=!1,i.remove()}return n.addEventListener("mousedown",a),n.addEventListener("mousemove",u),n.addEventListener("mouseup",m),{rect:i,cleanUp:f,disable:function(){null!=n&&n.removeEventListener("mousedown",a),null!=n&&n.removeEventListener("mousemove",u),null!=n&&n.removeEventListener("mouseup",m)},enable:function(){if(!n)throw new Error("The container element must be defined before enabling listeners!");null!=n&&n.addEventListener("mousedown",a),null!=n&&n.addEventListener("mousemove",u),null!=n&&n.addEventListener("mouseup",m)}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Selection;